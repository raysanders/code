# this logformat directive will give you a nice json formatted apache access log - suitable for sending to logstash:
#
#
  LogFormat "{ \
\"@server\":[\"server-hostname-fqdn\"],\
\"@vips\":[\"%v\"], \
\"@source\":\"%v%U%q\", \
\"@source_host\": \"%v\", \
\"@source_path\": \"%f\", \
\"@tags\":[\"Apache\",\"Access\"], \
\"@message\": \"%{X-Forwarded-For}i %l %u %t \\\"%r\\\" %>s %b\", \
\"@fields\": { \
\"timestamp\": \"%{%Y-%m-%dT%H:%M:%S%z}t\", \
\"clientip\": \"%{X-Forwarded-For}i\", \
\"duration\": %D, \
\"status\": %>s, \
\"request\": \"%U%q\", \
\"urlpath\": \"%U\", \
\"urlquery\": \"%q\", \
\"method\": \"%m\", \
\"referer\": \"%{Referer}i\", \
\"user-agent\": \"%{User-agent}i\", \
\"bytes\": %B \
} \
}" apache_json
#
#
# to make life really easy, send the output directly to logstash. I use log-udp.pl:
CustomLog "|/usr/local/bin/log-udp.pl log-server.fqdn 5000" apache_json
